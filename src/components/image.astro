---
import { getImage } from '@lib:assets.ts'

const { src } = Astro.props
const imageData = await getImage(src, { widths: [16, 32, 48, 64, 96, 128, 256, 384] })
---

<picture>
    {Object.values(imageData).map(imageType => (
        <source type={imageType[0].sourceType} srcset={imageType.map(image => image.srcset).join(', ')} sizes="100vw" />
    ))}
    <img src={imageData.jpeg[0].url} width={imageData.jpeg[imageData.jpeg.length - 1].width} height={imageData.jpeg[imageData.jpeg.length - 1].height} alt="" loading="lazy" decoding="async" />
</picture>